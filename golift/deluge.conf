# Deluge
location = /deluge {
    auth_request     /auth-2;
    auth_request_set $user $upstream_http_x_organizr_user;
    add_header       X-WEBAUTH-USER $user;
    return 301       https://$host/deluge/;
}

location ~ ^/deluge(?<requesturi>/.*)$ {
    auth_request     /auth-2;
    auth_request_set $user $upstream_http_x_organizr_user;
    include          /config/nginx/proxy.conf;
    add_header       X-WEBAUTH-USER $user;
    proxy_set_header X-Deluge-Base   "/deluge/";
    proxy_set_header X-Frame-Options "SAMEORIGIN";
    proxy_pass       $deluge$requesturi$is_args$args;
}
